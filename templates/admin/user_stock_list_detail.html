{% extends "base.html" %}

{% block title %}{{ user.username }} - {{ stock_list.name }} - ê´€ë¦¬ì{% endblock %}

{% block content %}
<div class="card">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
        <h2>ğŸ“Š {{ user.username }} - {{ stock_list.name }}</h2>
        <a href="{{ url_for('admin.user_stock_lists', user_id=user.id) }}" class="btn btn-secondary">â† ë¦¬ìŠ¤íŠ¸ ëª©ë¡ìœ¼ë¡œ</a>
    </div>
    
    <div style="background: #f8f9fa; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
        <h4>ë¦¬ìŠ¤íŠ¸ ì •ë³´</h4>
        <p><strong>ë¦¬ìŠ¤íŠ¸ëª…:</strong> {{ stock_list.name }}</p>
        {% if stock_list.description %}
            <p><strong>ì„¤ëª…:</strong> {{ stock_list.description }}</p>
        {% endif %}
        <p><strong>ì¢…ëª© ìˆ˜:</strong> {{ stocks|length }}ê°œ</p>
        <p><strong>ìƒì„±ì¼:</strong> {{ stock_list.created_at.strftime('%Y-%m-%d %H:%M') }}</p>
        <p><strong>ìƒíƒœ:</strong> 
            {% if stock_list.is_default %}
                <span style="background: #007bff; color: white; padding: 2px 6px; border-radius: 4px; font-size: 0.8rem;">ê¸°ë³¸ ë¦¬ìŠ¤íŠ¸</span>
            {% endif %}
            {% if stock_list.is_public %}
                <span style="background: #28a745; color: white; padding: 2px 6px; border-radius: 4px; font-size: 0.8rem; margin-left: 0.5rem;">ê³µê°œ</span>
            {% endif %}
        </p>
    </div>
</div>

<div class="card">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
        <h3>ğŸ“ˆ ì¢…ëª© ëª©ë¡ ({{ stocks|length }}ê°œ)</h3>
        <div style="display: flex; gap: 0.5rem;">
            <a href="{{ url_for('admin.add_stock_to_user_list', user_id=user.id, list_id=stock_list.id) }}" 
               class="btn btn-success">â• ì¢…ëª© ì¶”ê°€</a>
            <form method="POST" action="{{ url_for('admin.bulk_generate_for_user_list', user_id=user.id, list_id=stock_list.id) }}" 
                  style="display: inline;">
                <button type="submit" class="btn btn-primary" 
                        onclick="return confirm('ì´ ë¦¬ìŠ¤íŠ¸ì˜ ëª¨ë“  ì¢…ëª©ì— ëŒ€í•´ ì¼ê´„ ìƒì„±ì„ ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')">
                    ğŸš€ ì¼ê´„ ìƒì„±
                </button>
            </form>
        </div>
    </div>
    
    {% if stocks %}
        <div style="overflow-x: auto;">
            <table style="width: 100%; border-collapse: collapse; margin-top: 1rem;">
                <thead>
                    <tr style="background: #f8f9fa;">
                        <th style="padding: 0.75rem; text-align: left; border-bottom: 2px solid #dee2e6;">ì¢…ëª© ì½”ë“œ</th>
                        <th style="padding: 0.75rem; text-align: left; border-bottom: 2px solid #dee2e6;">ì¢…ëª©ëª…</th>
                        <th style="padding: 0.75rem; text-align: left; border-bottom: 2px solid #dee2e6;">ì¶”ê°€ì¼</th>
                        <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid #dee2e6;">ì‘ì—…</th>
                    </tr>
                </thead>
                <tbody>
                    {% for stock in stocks %}
                        <tr style="border-bottom: 1px solid #dee2e6;">
                            <td style="padding: 0.75rem;">
                                <strong>{{ stock.ticker }}</strong>
                            </td>
                            <td style="padding: 0.75rem;">
                                {{ stock.name or stock.ticker }}
                            </td>
                            <td style="padding: 0.75rem; color: #666; font-size: 0.9rem;">
                                {{ stock.created_at.strftime('%Y-%m-%d %H:%M') if stock.created_at else 'N/A' }}
                            </td>
                            <td style="padding: 0.75rem; text-align: center;">
                                <form method="POST" action="{{ url_for('admin.delete_stock_from_user_list', user_id=user.id, list_id=stock_list.id, stock_id=stock.id) }}" 
                                      style="display: inline;">
                                    <button type="submit" class="btn btn-danger btn-sm" 
                                            onclick="return confirm('ì •ë§ ì¢…ëª© {{ stock.ticker }}ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')">
                                        ì‚­ì œ
                                    </button>
                                </form>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <div style="text-align: center; padding: 2rem; color: #666;">
            <p>ì•„ì§ ì¢…ëª©ì´ ì—†ìŠµë‹ˆë‹¤.</p>
            <a href="{{ url_for('admin.add_stock_to_user_list', user_id=user.id, list_id=stock_list.id) }}" 
               class="btn btn-success">ì²« ë²ˆì§¸ ì¢…ëª© ì¶”ê°€í•˜ê¸°</a>
        </div>
    {% endif %}
</div>

<div class="card">
    <h3>ğŸ”§ ë¦¬ìŠ¤íŠ¸ ê´€ë¦¬</h3>
    <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
        <a href="{{ url_for('admin.edit_user_stock_list', user_id=user.id, list_id=stock_list.id) }}" 
           class="btn btn-warning">âœï¸ ë¦¬ìŠ¤íŠ¸ ìˆ˜ì •</a>
        
        {% if not stock_list.is_default %}
            <form method="POST" action="{{ url_for('admin.delete_user_stock_list', user_id=user.id, list_id=stock_list.id) }}" 
                  style="display: inline;">
                <button type="submit" class="btn btn-danger" 
                        onclick="return confirm('ì •ë§ ì´ ë¦¬ìŠ¤íŠ¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ëª¨ë“  ì¢…ëª©ì´ í•¨ê»˜ ì‚­ì œë©ë‹ˆë‹¤.')">
                    ğŸ—‘ï¸ ë¦¬ìŠ¤íŠ¸ ì‚­ì œ
                </button>
            </form>
        {% endif %}
        
        <a href="{{ url_for('admin.user_stock_lists', user_id=user.id) }}" class="btn btn-secondary">â† ë¦¬ìŠ¤íŠ¸ ëª©ë¡</a>
        <a href="{{ url_for('admin.admin_users') }}" class="btn btn-primary">ì‚¬ìš©ì ëª©ë¡</a>
    </div>
</div>
{% endblock %} 