{% extends "base.html" %}

{% block title %}ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ{% endblock %}

{% block content %}
<div class="card">
    <h1>âš™ï¸ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</h1>
    <p>ì‹œìŠ¤í…œ ì „ì²´ í˜„í™©ì„ í™•ì¸í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
</div>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
    <div class="card">
        <h3>ğŸ‘¥ ì‚¬ìš©ì í†µê³„</h3>
        <div style="font-size: 2rem; font-weight: bold; color: #007bff;">{{ total_users }}</div>
        <p>ì „ì²´ ì‚¬ìš©ì ìˆ˜</p>
    </div>
    
    <div class="card">
        <h3>ğŸ“‹ ì¢…ëª© ë¦¬ìŠ¤íŠ¸</h3>
        <div style="font-size: 2rem; font-weight: bold; color: #28a745;">{{ total_stock_lists }}</div>
        <p>ìƒì„±ëœ ë¦¬ìŠ¤íŠ¸ ìˆ˜</p>
    </div>
    
    <div class="card">
        <h3>ğŸ“Š ë¶„ì„ ê¸°ë¡</h3>
        <div style="font-size: 2rem; font-weight: bold; color: #ffc107;">{{ total_analyses }}</div>
        <p>ì´ ë¶„ì„ íšŸìˆ˜</p>
    </div>
</div>

<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
    <div class="card">
        <h3>ğŸ‘¥ ìµœê·¼ ê°€ì…í•œ ì‚¬ìš©ì</h3>
        {% if recent_users %}
            <table class="table">
                <thead>
                    <tr>
                        <th>ì‚¬ìš©ìëª…</th>
                        <th>ì´ë©”ì¼</th>
                        <th>ê°€ì…ì¼</th>
                        <th>ìƒíƒœ</th>
                    </tr>
                </thead>
                <tbody>
                    {% for user in recent_users %}
                    <tr>
                        <td>
                            {{ user.username }}
                            {% if user.is_administrator() %}
                                <span class="admin-badge">ê´€ë¦¬ì</span>
                            {% endif %}
                        </td>
                        <td>{{ user.email }}</td>
                        <td>{{ user.created_at.strftime('%Y-%m-%d') }}</td>
                        <td>
                            {% if user.is_active %}
                                <span style="color: #28a745;">í™œì„±</span>
                            {% else %}
                                <span style="color: #dc3545;">ë¹„í™œì„±</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p>ìµœê·¼ ê°€ì…í•œ ì‚¬ìš©ìê°€ ì—†ìŠµë‹ˆë‹¤.</p>
        {% endif %}
    </div>
    
    <div class="card">
        <h3>ğŸ“Š ìµœê·¼ ë¶„ì„ ê¸°ë¡</h3>
        {% if recent_analyses %}
            <table class="table">
                <thead>
                    <tr>
                        <th>ì¢…ëª©</th>
                        <th>ë¶„ì„ì¼</th>
                        <th>ì‚¬ìš©ì</th>
                        <th>ìƒíƒœ</th>
                    </tr>
                </thead>
                <tbody>
                    {% for analysis in recent_analyses %}
                    <tr>
                        <td>{{ analysis.ticker }}</td>
                        <td>{{ analysis.analysis_date.strftime('%Y-%m-%d') }}</td>
                        <td>{{ analysis.user.username }}</td>
                        <td>
                            {% if analysis.status == 'completed' %}
                                <span style="color: #28a745;">ì™„ë£Œ</span>
                            {% elif analysis.status == 'failed' %}
                                <span style="color: #dc3545;">ì‹¤íŒ¨</span>
                            {% else %}
                                <span style="color: #ffc107;">ì§„í–‰ì¤‘</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p>ìµœê·¼ ë¶„ì„ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p>
        {% endif %}
    </div>
</div>

<div class="card">
    <h3>ğŸ”§ ê´€ë¦¬ ë„êµ¬</h3>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
        <a href="{{ url_for('admin.admin_users') }}" class="btn btn-primary">ğŸ‘¥ ì‚¬ìš©ì ê´€ë¦¬</a>
        <a href="{{ url_for('admin.admin_analytics') }}" class="btn btn-success">ğŸ“Š ë¶„ì„ í†µê³„</a>
        <a href="{{ url_for('admin.admin_system') }}" class="btn btn-secondary">ğŸ’» ì‹œìŠ¤í…œ ì •ë³´</a>
        <a href="{{ url_for('admin.admin_logs') }}" class="btn btn-info">ğŸ“‹ ë¡œê·¸ ëª¨ë‹ˆí„°ë§</a>
        <a href="{{ url_for('admin.cleanup_debug_files') }}" class="btn btn-warning" 
           onclick="return confirm('Debug íŒŒì¼ë“¤ì„ ë‚ ì§œë³„ í´ë”ë¡œ ì •ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')">
           ğŸ—‚ï¸ Debug íŒŒì¼ ì •ë¦¬
        </a>
    </div>
</div>
{% endblock %} 